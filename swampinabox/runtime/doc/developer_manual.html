<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>SIB Developer Manual</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>SIB Developer Manual</h1>
<div class="details">
<span id="revnumber">version 1.37,</span>
<span id="revdate">2020-12-30 19:58:19 -0600</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_overview">1. Overview</a></li>
<li><a href="#_before_you_begin">2. Before You Begin</a>
<ul class="sectlevel2">
<li><a href="#_frameworks_and_htcondor">2.1. Frameworks and HTCondor</a></li>
</ul>
</li>
<li><a href="#_building_sib">3. Building SIB</a>
<ul class="sectlevel2">
<li><a href="#_obtaining_the_sib_source">3.1. Obtaining the SIB Source</a></li>
<li><a href="#_github_vs_workspace_repository_clones">3.2. GitHub vs Workspace Repository Clones</a></li>
<li><a href="#_build_parameters">3.3. Build Parameters</a></li>
<li><a href="#_building_the_tools_bundle">3.4. Building the Tools Bundle</a></li>
<li><a href="#_building_the_sib_release">3.5. Building the SIB Release</a></li>
</ul>
</li>
<li><a href="#_customizing_sib">4. Customizing SIB</a>
<ul class="sectlevel2">
<li><a href="#_documentation">4.1. Documentation</a></li>
<li><a href="#_rpms">4.2. RPMs</a></li>
</ul>
</li>
<li><a href="#_perl_architecture">5. Perl Architecture</a>
<ul class="sectlevel2">
<li><a href="#_database_bash_scripts_called_by_sys_exec_and_sys_eval">5.1. Database <code>bash</code> Scripts Called by <code>sys_exec</code> and <code>sys_eval</code></a></li>
<li><a href="#_daemons_managed_by_the_swamp_init_script">5.2. Daemons Managed by The <code>swamp</code> Init Script</a></li>
<li><a href="#_htcondor_job_scripts">5.3. HTCondor Job Scripts</a></li>
<li><a href="#_scarf_stream_parsing_to_json">5.4. SCARF Stream Parsing to JSON</a></li>
<li><a href="#_perl_backend_support_modules">5.5. Perl Backend Support Modules</a></li>
<li><a href="#_htcondor_command_utilization">5.6. HTCondor Command Utilization</a></li>
<li><a href="#_building_the_perl_runtime_distribution_archive">5.7. Building the Perl Runtime Distribution Archive</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_overview">1. Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This guide has been split into a few key sections.  The following sections will provide details for each step of the process.  The build process for SIB contains many parts that need to be performed in a specific order.  It is recommended to use a build system such as Jenkins to automate this process. The layout of the process has been taken directly from the steps performed by Jenkins.  Additionally, examples of how to make some common modifications will be given.   Knowledge of how to use GIT is required to properly maintain local customizations to SIB.</p>
</div>
<div class="paragraph">
<p>The SIB source code is made available at <a href="https://github.com/mirswamp/deployment">GitHub</a> in the following repositories:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://github.com/mirswamp/deployment"><code>deployment</code></a></dt>
<dd>
<p>Contains the SIB installer.</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/mirswamp/db"><code>db</code></a></dt>
<dd>
<p>Database and database upgrade paths.</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/mirswamp/services"><code>services</code></a></dt>
<dd>
<p>Java and Perl code for assessments.</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/mirswamp/swamp-web-server"><code>swamp-web-server</code></a></dt>
<dd>
<p>SIB web server that includes customized <a href="https://laravel.com">Laravel</a> framework code.</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/mirswamp/www-front-end"><code>www-front-end</code></a></dt>
<dd>
<p>Web front end code.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Additional supporting code is contained in the following repositories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/mirswamp/c-assess"><code>c-assess</code></a></p>
</li>
<li>
<p><a href="https://github.com/mirswamp/java-assess"><code>java-assess</code></a></p>
</li>
<li>
<p><a href="https://github.com/mirswamp/ruby-assess"><code>ruby-assess</code></a></p>
</li>
<li>
<p><a href="https://github.com/mirswamp/script-assess"><code>script-assess</code></a></p>
</li>
<li>
<p><a href="https://github.com/mirswamp/resultparser"><code>resultparser</code></a></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This document does not cover building the frameworks or result parser.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_before_you_begin">2. Before You Begin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Building SIB includes components that are not built with the build process described in this document.  These compoents are included with the SIB installer to be installed in an SIB instance.</p>
</div>
<div class="sect2">
<h3 id="_frameworks_and_htcondor">2.1. Frameworks and HTCondor</h3>
<div class="sect3">
<h4 id="_frameworks">2.1.1. Frameworks</h4>
<div class="paragraph">
<p>These are found as directories within the <code>/opt/swamp/thirdparty</code> directory on an already installed SIB instance.  Recreate the <code>.tar</code> files from the directories.  Make sure you are extracting these frameworks from the same SIB release version that you are attempting to build.  SIB releases depend on specific versions of these frameworks.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The GitHub repositories listed above are incomplete. Do NOT attempt to create the required <code>.tar</code> files from the GitHub repositories.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Obtaining Frameworks and Result Parser Example</div>
<div class="content">
<pre>cd /opt/swamp/thirdparty
for framework in c-assess-1.2.6 \
java-assess-2.7.6 \
ruby-assess-1.2.5 \
script-assess-1.4.5 ;
do tar cf /tmp/${framework}.tar ${framework} ; done
tar cf /tmp/resultparser-3.3.4.tar resultparser-3.3.4</pre>
</div>
</div>
<div class="paragraph">
<p>Copy the <code>.tar</code> files to <code>/swampcs/releases</code> on the machine you are building SIB.</p>
</div>
</div>
<div class="sect3">
<h4 id="_htcondor">2.1.2. HTCondor</h4>
<div class="paragraph">
<p>SIB includes a custom release of HTCondor.  To successfully build the SIB installer, copy the HTCondor <code>.tar</code> files from <code>&lt;sib installer&gt;/dependencies/htcondor</code> directory to <code>/swampcs/htcondor</code> on the machine you are building SIB.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_building_sib">3. Building SIB</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_obtaining_the_sib_source">3.1. Obtaining the SIB Source</h3>
<div class="paragraph">
<p>Obtain the SIB source by cloning the following GIT repositories from GitHub. Next, create branches based on the release &lt;tag&gt; for the current release.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://github.com/mirswamp/deployment"><code>deployment</code></a></dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>git clone https://github.com/mirswamp/deployment.git
cd deployment; git checkout tags/v1.37 -b 1.37-release</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://github.com/mirswamp/db"><code>db</code></a></dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>git clone https://github.com/mirswamp/db.git
cd db; git checkout tags/v1.37 -b 1.37-release</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://github.com/mirswamp/services"><code>services</code></a></dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>git clone https://github.com/mirswamp/services.git
cd services; git checkout tags/v1.37 -b 1.37-release</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://github.com/mirswamp/swamp-web-server"><code>swamp-web-server</code></a></dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>git clone https://github.com/mirswamp/swamp-web-server.git
cd swamp-web-server; git checkout tags/v1.37 -b 1.37-release</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://github.com/mirswamp/www-front-end"><code>www-front-end</code></a></dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>git clone https://github.com/mirswamp/www-front-end.git
cd www-front-end; git checkout tags/v1.37 -b 1.37-release</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_github_vs_workspace_repository_clones">3.2. GitHub vs Workspace Repository Clones</h3>
<div class="paragraph">
<p>The repository clones (GitHub Clones) created in the previous section are where you will commit your local customizations.  During the building of SIB, you will be building from clones of the <strong><em>GitHub Clones</em></strong>, these clones will be called <strong><em>Workspace Clones</em></strong>.</p>
</div>
<div class="paragraph">
<p>In this example, the current directory is <code>~/sib</code>.</p>
</div>
<div class="listingblock">
<div class="title">GitHub Clone</div>
<div class="content">
<pre>mkdir sibsource
cd sibsource
git clone https://github.com/mirswamp/deployment.git
cd deployment; git checkout tags/v1.37 -b 1.37-release</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Workspace Clone</div>
<div class="content">
<pre>mkdir sibbuild
cd sibbuild
git clone ../sibsource/deployment deployment
cd deployment; git checkout tags/v1.37 -b 1.37-release</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_build_parameters">3.3. Build Parameters</h3>
<div class="paragraph">
<p>The following  parameters are used for building SIB. <code>BRANCH</code>, <code>RELEASE_NUMBER</code>, and <code>BUILD_TAG</code> are typically set up as Build Parameters in Jenkins and <code>WORKSPACE</code> and <code>BUILD_NUMBER</code> are auto populated by Jenkins.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BRANCH</code></p>
</li>
<li>
<p><code>RELEASE_NUMBER</code></p>
</li>
<li>
<p><code>BUILD_TAG</code></p>
</li>
<li>
<p><code>BUILD_NUMBER</code></p>
</li>
<li>
<p><code>WORKSPACE</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_building_the_tools_bundle">3.4. Building the Tools Bundle</h3>
<div class="paragraph">
<p>The following GIT repositories are used for building the tools bundle.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/mirswamp/deployment"><code>deployment</code></a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If there are no changes to the tools bundle, you can skip building it and download <a href="https://platform.swampinabox.org/siab-1.37-release/swampinabox-1.37-tools.tar.gz"><code>swampinabox-1.37-tools.tar.gz</code></a>.  To rebuild the tools bundle, download the version corresponding to your SIB release and extract it and move the files to <code>/swampcs/releases</code>.  Otherwise, copy it to your <code>BUILD_ROOT</code> directory.  It is also included with initial installer download.  Simply copy this file into your <code>BUILD_ROOT</code> to save a step of downloading the file again.</p>
</div>
<div class="paragraph">
<p>Save the following script as <code>build_tools_bundle.bash</code> in the directory where your <strong><em>Workspace Clones</em></strong> are located. This location is your workspace. Edit the parameters at the top of the script as necessary.</p>
</div>
<div class="listingblock">
<div class="title">build_tools_bundle.bash</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">#!/usr/bin/env bash

# Set these to a location with significant space
BUILD_ROOT_LOCATION=/sib/buildroot <i class="conum" data-value="1"></i><b>(1)</b>
WORKSPACE=/sib <i class="conum" data-value="2"></i><b>(2)</b>

# Build versioning parameters
RELEASE_NUMBER=1.37 <i class="conum" data-value="3"></i><b>(3)</b>
BRANCH=1.37-release <i class="conum" data-value="4"></i><b>(4)</b>
BUILD_TAG=sib <i class="conum" data-value="5"></i><b>(5)</b>
BUILD_NUMBER=1 <i class="conum" data-value="6"></i><b>(6)</b>

TYPE=tools
ARCHIVE_ROOT_DIR=swampinabox-${RELEASE_NUMBER}-${TYPE}
SIB_ROOT=$WORKSPACE/deployment/swampinabox
BUILD_ROOT=${BUILD_ROOT_LOCATION}/swampinabox/bundles/$ARCHIVE_ROOT_DIR

rm -rf "${ARCHIVE_ROOT_DIR}" "${BUILD_ROOT}"

mkdir -p "${BUILD_ROOT}"

"$SIB_ROOT"/distribution/util/build-archive.pl \
    --inventory    "$WORKSPACE/deployment/inventory/tools-bundled.txt" \
    --inventory    "$WORKSPACE/deployment/inventory/tools-metric.txt" \
    --output-file  "${BUILD_ROOT}/${ARCHIVE_ROOT_DIR}.tar.gz" \
    --root-dir     "${ARCHIVE_ROOT_DIR}" \
    --version      "${RELEASE_NUMBER}" \
    --build        "${BUILD_NUMBER}" \
  || exit 1

for path in "$BUILD_ROOT"/* ; do
    if [ -f "$path" ]; then
        { cd -- "$(dirname -- "$path")" &amp;&amp; md5sum "$(basename -- "$path")"
        } &gt; "$path".md5
    fi
done

chmod -R u=rwX,og=rX "$BUILD_ROOT"</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Set this to the path of where the build artifacts will be saved.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Set this to the path of your WORKSPACE location. If you are attmpting to use this script inside Jenkins, comment this out.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Set this to the release number. If you are attempting to use this script inside Jenkins, make this a build parameter and comment this out.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Set this to the branch you are building. If you are attempting to use this script inside Jenkins, make this a build parameter and comment this out.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Set this to the tag of the build.  It can be any string with the purpose of labeling if a build is a development build or not. If you are attempting to use this script inside Jenkins, make this a build parameter and comment this out.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Set this to the build number.  Increment this between builds of the same release so that they will be treated as upgrades. If you are attempting to use this script in Jenkins, comment this out.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_building_the_sib_release">3.5. Building the SIB Release</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The tools bundle must be in place prior to building SIB itself.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This step assumes that all local customizations have been committed to the <strong><em>GitHub Clones</em></strong>.  Instructions for where to apply local customizations within the source code will be shown later in this document.  So, commit your local customizations and then generate your <strong><em>Workspace Clones</em></strong> into a clean workspace prior to initiating a new build.  The build scripts utilized were written with the behavior of Jenkins in mind.  So, don&#8217;t perform the build using <strong><em>GitHub Clones</em></strong> directly.</p>
</div>
<div class="paragraph">
<p>Install the following RPM packages on the machine you are building SIB.</p>
</div>
<div class="listingblock">
<div class="title">Install Build Dependencies</div>
<div class="content">
<pre>yum install rpm-build cmake ruby gcc doxygen libxml2-devel</pre>
</div>
</div>
<div class="paragraph">
<p>Save the following script as <code>build_sib_installer.bash</code> in the workspace directory where you created the <strong><em>WorkSpace Clones</em></strong>.  Edit the parameters at the top of the script as necessary.</p>
</div>
<div class="listingblock">
<div class="title">build_sib_installer.bash</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">#!/usr/bin/env bash

# Set these to a location with significant space
BUILD_ROOT_LOCATION=/sib/buildroot <i class="conum" data-value="1"></i><b>(1)</b>
WORKSPACE=/sib <i class="conum" data-value="2"></i><b>(2)</b>

# Build versioning parameters
RELEASE_NUMBER=1.37 <i class="conum" data-value="3"></i><b>(3)</b>
BRANCH=1.37-release <i class="conum" data-value="4"></i><b>(4)</b>
BUILD_TAG=sib <i class="conum" data-value="5"></i><b>(5)</b>
BUILD_NUMBER=1 <i class="conum" data-value="6"></i><b>(6)</b>

SIB_ROOT=$WORKSPACE/deployment/swampinabox
BUILD_ROOT=$WORKSPACE/export/swampinabox/distribution

mkdir -p "${BUILD_ROOT}"

"$SIB_ROOT"/distribution/util/build-installer.bash \
    "${RELEASE_NUMBER}" \
    "${BUILD_NUMBER}.${BUILD_TAG}" \
  || exit 1

"$SIB_ROOT"/distribution/util/build-release.bash \
    "${RELEASE_NUMBER}" \
    "${BUILD_ROOT_LOCATION}/swampinabox/builds/${RELEASE_NUMBER}-${BUILD_NUMBER}.${BUILD_TAG}" \
    "${BUILD_ROOT}/swampinabox-${RELEASE_NUMBER}-installer" \
    "${BUILD_ROOT_LOCATION}/swampinabox/bundles/swampinabox-${RELEASE_NUMBER}-tools" \
  || exit 1</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Set this to the path of where the build artifacts will be saved.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Set this to the path of your WORKSPACE location. If you are attmpting to use this script inside Jenkins, comment this out.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Set this to the release number. If you are attempting to use this script inside Jenkins, make this a build parameter and comment this out.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Set this to the branch you are building. If you are attempting to use this script inside Jenkins, make this a build parameter and comment this out.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Set this to the tag of the build.  It can be any string with the purpose of labeling if a build is a development build or not. If you are attempting to use this script inside Jenkins, make this a build parameter and comment this out.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Set this to the build number.  Increment this between builds of the same release so that they will be treated as upgrades. If you are attempting to use this script in Jenkins, comment this out.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This build environment needs to be ran as a normal user.  To initiate a build, run <code>build_sib_installer.bash</code>.  When the script finishes, you will see the following message:</p>
</div>
<div class="listingblock">
<div class="title">Successful Build Message</div>
<div class="content">
<pre>Finished building the installer

### Assembling SWAMP-in-a-Box Release

Version:            1.37
Release directory:  /sib/buildroot/swampinabox/builds/1.37-1.sib
Working directory:  /sib

Finished assembling the release</pre>
</div>
</div>
<div class="paragraph">
<p>The new build artifacts have been saved to the release directory.  This build can then be used to upgrade an existing SIB instance to this build that now includes the local customizations.</p>
</div>
<div class="paragraph">
<p>If there were errors detected in the build process, the following message will be displayed instead.</p>
</div>
<div class="listingblock">
<div class="title">Build Failure Message</div>
<div class="content">
<pre>Finished building the installer, but with errors</pre>
</div>
</div>
<div class="paragraph">
<p>If your build does not display either of these messages, something went wrong beyond the error dection of the build scripts.  Examine the build output generated for failures.  This typically happens when a build time dependency has not been met.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_customizing_sib">4. Customizing SIB</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">4.1. Documentation</h3>
<div class="paragraph">
<p>The SIB documentation is built separately from SIB itself.  However, the built documentation files are included within a build of a SIB release. The documentation resides in the <a href="https://github.com/mirswamp/deployment"><code>deployment</code></a> repository in the <code>swampinabox/runtime/doc</code> directory.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Modifications to the documentation occur in the <strong><em>GitHub Clone</em></strong>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_before_you_begin_2">4.1.1. Before You Begin</h4>
<div class="paragraph">
<p>The documentation is built using <code>asciidoctor</code> and <code>asciidoctor-pdf</code>.  Perform these steps to install these tools.</p>
</div>
<div class="listingblock">
<div class="title">Install asciidoctor</div>
<div class="content">
<pre>yum install asciidoctor</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Install asciidoctor-pdf</div>
<div class="content">
<pre>yum install centos-release-scl-rh
yum --enablerepo=centos-sclo-rh -y install rh-ruby23
scl enable rh-ruby23 'gem install asciidoctor-pdf --pre'</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_building_the_documentation">4.1.2. Building The Documentation</h4>
<div class="paragraph">
<p>There are two types of files envolved.  The AsciiDoc source files and the generated HTML and PDF files.  Refer to <a href="https://asciidoctor.org/docs/"><code>Asciidoctor Documentation</code></a> for the proper syntax for modifying the documentation.</p>
</div>
<div class="paragraph">
<p>The AsciiDoc source files are contained within subdirctories of the <code>swampinabox/runtime/doc</code> directory.  The current manuals are these:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>SIB Administrator Manual</em> in the <code>administrator_manual</code> directory</p>
</li>
<li>
<p><em>SIB Reference Manual</em> in the <code>reference_manual</code> directory</p>
</li>
<li>
<p><em>SIB Developer Manual</em> in the <code>developer_manual</code> directory</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a script that is ran to generate the PDF and HTML files from the AsciiDoc sources.  This script is in the <code>swampinabox/distribution/util</code> directory.</p>
</div>
<div class="paragraph">
<p>In this example, the current directory is <code>swampinabox/runtime/doc</code>:</p>
</div>
<div class="listingblock">
<div class="title">build_manuals.bash Example</div>
<div class="content">
<pre>scl enable rh-ruby23 ../../distribution/util/build_manuals.bash</pre>
</div>
</div>
<div class="paragraph">
<p>Once the <code>build_manuals.bash</code> script completes, commit the changes to the AsciiDoc sources, the HTML files, and the PDF files.  The HTML and PDF files will be included in the SIB installer.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rpms">4.2. RPMs</h3>
<div class="paragraph">
<p>SIB uses RPM as its package management format.  The following RPMs are built and included in the SIB installer. The additional separate <code>.txt</code> files are shared with the SWAMP facility packages.</p>
</div>
<div class="paragraph">
<p>Package <code>swamp-rt-perl</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>RPM <code>swamp-rt-perl-1.37-1.sib.noarch.rpm</code></p>
</li>
<li>
<p>SPEC <code>swamp-rt-perl.spec</code></p>
</li>
<li>
<p>Location</p>
<div class="ulist">
<ul>
<li>
<p><code>deployment/swamp/runtime-installer/SPECS</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Package <code>swampinabox-backend</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>RPM <code>swampinabox-backend-1.37-1.sib.norarch.rpm</code></p>
</li>
<li>
<p>SPEC <code>swampinabox-backend.spec</code></p>
</li>
<li>
<p>Location</p>
<div class="ulist">
<ul>
<li>
<p><code>deployment/swmap/installer/SPECS</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Additional Files</p>
<div class="ulist">
<ul>
<li>
<p><code>common-files-data.txt</code></p>
</li>
<li>
<p><code>common-files-exec.txt</code></p>
</li>
<li>
<p><code>common-files-submit.txt</code></p>
</li>
<li>
<p><code>common-install-data.txt</code></p>
</li>
<li>
<p><code>common-install-exec.txt</code></p>
</li>
<li>
<p><code>common-install-submit.txt</code></p>
</li>
<li>
<p><code>swampinabox-files-data.txt</code></p>
</li>
<li>
<p><code>swampinabox-files-exec.txt</code></p>
</li>
<li>
<p><code>swampinabox-files-general.txt</code></p>
</li>
<li>
<p><code>swampinabox-files-submit.txt</code></p>
</li>
<li>
<p><code>swampinabox-install-data.txt</code></p>
</li>
<li>
<p><code>swampinabox-install-exec.txt</code></p>
</li>
<li>
<p><code>swampinabox-install-general.txt</code></p>
</li>
<li>
<p><code>swampinabox-install-submit.txt</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Package <code>swamp-web-server</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>RPM <code>swamp-web-server-1.37-1.sib.noarch.rpm</code></p>
</li>
<li>
<p>SPEC <code>swamp-web-server.spec</code></p>
</li>
<li>
<p>Location</p>
<div class="ulist">
<ul>
<li>
<p><code>deployment/swmap/swamp-web-server-installer/SPECS</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_perl_architecture">5. Perl Architecture</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are currently three deployment flavors of SWAMP - the original multi-host facility deployment, the
singleserver facility deployment <em>(primarily used for development purposes but should be extended as a
replacement for the multi-host version in the future)</em>, and the swampinabox deployment intended for
distribution and installation at user sites.</p>
</div>
<div class="paragraph">
<p>For the multi-host design, the relevant host nodes consist of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Web Server</p>
<div class="ulist">
<ul>
<li>
<p>The HTML service routes are executed on this server.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Data Server</p>
<div class="ulist">
<ul>
<li>
<p>The MariaDB database server is executed here.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Submit Server</p>
<div class="ulist">
<ul>
<li>
<p>The SWAMP daemon(s) execute here.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Execute Servers (one or more)</p>
<div class="ulist">
<ul>
<li>
<p>The viewer and assessment machines <em>(virtual machines 'vm'  and docker containers 'dc')</em> execute here.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are additional host(s) used for the installation and deployment of HTCondor which is used as a job
management tool. In particular, there is a HTCondor host where the collector runs. This collector is
briefly described below.</p>
</div>
<div class="paragraph">
<p>The Perl backend is the component that manages jobs in the SWAMP system.</p>
</div>
<div class="paragraph">
<p>There are two kinds of jobs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>assessments</p>
</li>
<li>
<p>viewers</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All jobs are submitted to HTCondor to be executed in either a virtual machine (vm universe) or a
docker container (docker universe). One fundamental difference between assessment jobs and viewer jobs
is that assessment jobs are expected to run to completion; typically on the order of minutes for
processing, while viewer jobs are run under end user control and therefore are expected to run
indefinitely as long as the user&#8217;s client web application interface maintains a connection
to the viewer machine.</p>
</div>
<div class="paragraph">
<p>The Perl backend is responsible for responding to requests from the database to launch assessment and viewer jobs
and to kill jobs by removing them from the HTCondor queue. All job management is performed by executing operating
system shell level commands using the perl <code>system</code> procedure call. All requests initiated by the database are
performed using the <code>sys_exec</code> and <code>sys_eval</code> user extensions to the MariaDB server.  The two database user commands
only differ in that <code>sys_exec</code> executes shell commands without gathering the command output, while <code>sys_eval</code> provides
the extra step of gathering the output of the commands and returns it to the caller.</p>
</div>
<div class="paragraph">
<p>Each job has an execution record uuid (execrunuid) that uniquely identifies the job.
There is also an HTCondor job id
that is used to identify the job once it is submitted to and managed by HTCondor. The mechanism for making
the correspondence between the SWAMP execrunuid and the HTCondor job is a Perl subroutine <code>getHTCondorJobId</code>
that invokes the <code>condor_q</code> command with the execrunuid as a constraint.</p>
</div>
<div class="paragraph">
<p>Assessment and viewer job progress is monitored by Perl monitoring scripts that are launched with each job and
communicate with the job&#8217;s machine (vm or dc) via a tty to file connection. Inside the machine, the connection
looks like a tty, outside the machine, the monitoring script sees a file. Communication between the Perl
monitoring scripts and the rest of the SWAMP system is obtained by use of HTCondor&#8217;s collector functionality.
A separate HTCondor collector is started when the SWAMP system is installed, that is used to facilitate this
communication. In this way, the web service code can check the HTCondor collector for status information
regarding jobs that are initiated by the web service.</p>
</div>
<div class="sect2">
<h3 id="_database_bash_scripts_called_by_sys_exec_and_sys_eval">5.1. Database <code>bash</code> Scripts Called by <code>sys_exec</code> and <code>sys_eval</code></h3>
<div class="paragraph">
<p>There are three entry points into the Perl backend from the database. They are simple bash scripts that call
their corresponding Perl scripts, passing all arguments and returning all results.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>/usr/local/bin/launch_viewer</code> - launch a viewer job in HTCondor</p>
</li>
<li>
<p><code>/usr/local/bin/kill_run</code> - remove an assessment or viewer job from the HTCondor queue</p>
</li>
<li>
<p><code>/usr/local/bin/execute_execution_record</code> - launch an assessment job in HTCondor</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_perl_entry_scripts_called_by_database_bash_scripts">5.1.1. Perl Entry Scripts Called by Database <code>bash</code> Scripts</h4>
<div class="paragraph">
<p>These three Perl scripts correspond directly with their bash counterparts described above. Each of these
scripts perform setup computations and then use <code>RPC::XML</code> to communicate requests to the child daemons
described below. These scripts take an execrunuid as argument from the database invocation as the SWAMP
job identifier. When needed, these scripts execute database queries to obtain the requisite data to
submit the job or perform the task.</p>
</div>
<div class="sect4">
<h5 id="_vmu_launchviewer_pl"><code>vmu_launchviewer.pl</code></h5>
<div class="paragraph">
<p>This script is the backend entry point for submitting an HTCondor viewer job, monitoring its progress, and collecting the output when the job finishes. Collected output consists of the CodeDX viewer database, the CodeDX configuration files, and the CodeDX log files. This script is also responsible for preparing native viewer json data and error/warning report json data. In these later cases, no HTCondor job is submitted.</p>
</div>
<div class="paragraph">
<p>This script prepares the input directory for the viewer machine, prepares the HTCondor submit file, and submits the HTCondor job. In the case of CodeDX viewer jobs, this script uploads the package archive and the viewer SCARF results to the viewer machine using the <code>curl</code> command via the Perl <code>system</code> call. It is capable of uploading to a personal CodeDX viewer machine or an enterprise wide CodeDX installation.</p>
</div>
</div>
<div class="sect4">
<h5 id="_vmu_calldorun_pl"><code>vmu_calldorun.pl</code></h5>
<div class="paragraph">
<p>This is the analagous backend entry point for submitting an HTCondor assessment job. It has similar charactersitics as the viewer launch script. Collected output consists of the archive of the output disk of the assessment machine which contains either the assessment results if successful, or the error report data in the case of failure.</p>
</div>
</div>
<div class="sect4">
<h5 id="_vmu_killrun_pl"><code>vmu_killrun.pl</code></h5>
<div class="paragraph">
<p>This script is the backend entry point for removal of the HTCondor job that corresponds to a SWAMP job. Translation is made between the SWAMP execrunuid and the HTCondor job id and <code>condor_rm</code> is used to shutdown the job. For viewer jobs, and attempt is made to ensure a graceful shutdown so that the viewer output can be collected. For assessment jobs, a hard kill is performed and any job results are ignored.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_daemons_managed_by_the_swamp_init_script">5.2. Daemons Managed by The <code>swamp</code> Init Script</h3>
<div class="paragraph">
<p>The SWAMP daemon(s) are architected for the original multi-host SWAMP facility. They are used in the singleserver
and SIB versions of SWAMP to keep the code base uniform across implementation flavors. A strongly recommended
future direction is to eliminate the multi-host implementation, move all job control functionality to the web
service code, and thereby eliminate the Perl backend altogether.</p>
</div>
<div class="paragraph">
<p>The daemon(s) are implemented as an operating system service. The entry point for the service is the
vmu_swamp_monitor. It is controlled by <code>systemctl</code> <code>start</code>/<code>stop</code>/<code>status</code>. It in turn controls the remaining
Perl script child daemons that are written to run indefinitely, detached from a tty. There is keep-alive
functionality built in to the service that restarts child daemons when their crash is detected.</p>
</div>
<div class="sect3">
<h4 id="_vmu_swamp_monitor">5.2.1. <code>vmu_swamp_monitor</code></h4>
<div class="paragraph">
<p>This is the operating system service daemon. It serves only to manage the child daemons.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vmu_launchpad_pl">5.2.2. <code>vmu_LaunchPad.pl</code></h4>
<div class="paragraph">
<p>This child daemon serves to kill HTCondor jobs via condor_rm, and to launch assessment jobs after the BOG (Bill of Goods) is prepared.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vmu_agentmonitor_pl">5.2.3. <code>vmu_AgentMonitor.pl</code></h4>
<div class="paragraph">
<p>This child daemon serves to launch viewer jobs after the BOG is prepared. This is written as a separate daemon to simplify giving viewer jobs higher priority than other tasks.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vmu_csa_agent_pl">5.2.4. <code>vmu_csa_agent.pl</code></h4>
<div class="paragraph">
<p>This child daemon manages preparation of HTCondor job submit files from BOGs. Assessment jobs have their BOG written to the filesystem and this daemon monitors the filesystem for such BOGs to be executed in queue fashion. There is a single instance of this daemon that runs continuously, monitoring for assessment job BOGs.</p>
</div>
<div class="paragraph">
<p>This child daemon is also started on demand to submit HTCondor jobs for viewers. This provides for immediate response to a viewer request.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vmu_perl_launcher">5.2.5. <code>vmu_perl_launcher</code></h4>
<div class="paragraph">
<p>This is not a daemon. It is a script referenced by the vmu_csa_agent.pl daemon described above. It is the preamble setup script handed off to HTCondor via the submit file, that is used to manage the execution of the HTCondor jobs scripts described below.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_htcondor_job_scripts">5.3. HTCondor Job Scripts</h3>
<div class="paragraph">
<p>These scripts are essentially controlled by HTCondor after the job&#8217;s submission, and in the case of the multi-host facility, run on the execute node along side the job machine (vm or dc). The <code>Pre*</code> scripts are HTCondor hooks invoked after the HTCondor job is submitted and before its machine is started. Each <code>Monitor*</code> script is started by the corresponding <code>Pre*</code> script so it is not technically started by HTCondor, but HTCondor does control
removing this script upon cleanup of abnormal termination of the HTCondor job.</p>
</div>
<div class="paragraph">
<p>In the case of assessment jobs, the framework that runs the assessment includes the controlling script that is started by the init system of the assessment machine (vm or dc). Communication with this controlling script is obtained by a configuration file. In the case of viewer jobs, the controlling script that is started by the init system of the viewer machine (vm or dc) is configured and passed in to the machine in the input directory.</p>
</div>
<div class="sect3">
<h4 id="_vmu_preassessment_pl">5.3.1. <code>vmu_PreAssessment.pl</code></h4>
<div class="paragraph">
<p>This script creates the input and output directories of the machine. In the case of vm, they are implemented as mountable filesystems where mounting is done in the machine. In the case of dc, they are implemented as folders that are accessed in the filesystem of the machine&#8217;s execution environment. The script populates the input directory with the framework needed to run the assessment, and patches the machine&#8217;s init system to run a prescribed script on startup. This allows for the unattended execution of assessments. This script sets up the monitoring connection between the machine and its execution environment.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vmu_monitorassessment_pl">5.3.2. <code>vmu_MonitorAssessment.pl</code></h4>
<div class="paragraph">
<p>This script opens a connection to the machine via the filesystem. It reads single word status lines from the event file until it detects the final status of a successfully executed machine task. These statuses are communicated to the rest of the SWAMP system (in particular the web service) via the HTCondor collector. In the case of abnormal termination of a job, this script is expected to have transmitted its most recently detected status to the collector and it is cleaned up by the HTCondor supervisor.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vmu_postassessment_pl">5.3.3. <code>vmu_PostAssessment.pl</code></h4>
<div class="paragraph">
<p>This script archives the input and output of the machine and stores it in a temporary location for analysis. Upon completion of the job, the output archive is also stored permanently in the filesystem with its location recorded and managed by the database.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vmu_previewer_pl">5.3.4. <code>vmu_PreViewer.pl</code></h4>
<div class="paragraph">
<p>This script is analagous to the assessment job version. A major difference is that it prepares the controlling script and puts it in the input directory instead of preparing a configuration file to drive an embedded script.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vmu_monitorviewer_pl">5.3.5. <code>vmu_MonitorViewer.pl</code></h4>
<div class="paragraph">
<p>This script works analagously to the assessment job version.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vmu_postviewer_pl">5.3.6. <code>vmu_PostViewer.pl</code></h4>
<div class="paragraph">
<p>This script collects job output which consists of the codedx user database, configuration, package archive files and some log files that are useful for debugging.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_scarf_stream_parsing_to_json">5.4. SCARF Stream Parsing to JSON</h3>
<div class="paragraph">
<p>This subsystem is used to provide stream parsing of assessment job output SCARF xml files. This is a performance requirement since the Perl code and modules available to perform the task of parsing xml files is not able to handle extremely large files without exceeding memory requirements and causing an execution crash. This code is written in the C language and utilizes framework support for stream parsing of SCARF xml files. The Makefile to
build the executable stream parsing program is provided with the subsystem. It is invoked as part of the installation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Makefile
AttributeJsonReader.c
AttributeJsonReader.h
ScarfCommon.h
ScarfJson.h
ScarfJsonWriter.c
ScarfXml.h
ScarfXmlReader.c
vmu_Scarf_Cparsing.c</code></pre>
</div>
</div>
<div class="paragraph">
<p>This source code can be found in the <a href="https://github.com/mirswamp/deployment"><code>services</code></a> repository in the <code>services/perl/agents/Scarf_Parsing_C</code> directory.</p>
</div>
</div>
<div class="sect2">
<h3 id="_perl_backend_support_modules">5.5. Perl Backend Support Modules</h3>
<div class="paragraph">
<p>These Perl modules are written uniformly to expose their set of subroutines to caller scripts.</p>
</div>
<div class="sect3">
<h4 id="_vmu_support_pm">5.5.1. <code>vmu_Support.pm</code></h4>
<div class="paragraph">
<p>This provides general suppport subroutines that are used by both assessment jobs and viewer jobs. There are logging support routines, configuration support routines, HTCondor support routines, libvirt support routines (for virtual machines) and operating system interface routines.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vmu_assessmentsupport_pm">5.5.2. <code>vmu_AssessmentSupport.pm</code></h4>
<div class="paragraph">
<p>This provides the assessment job specific routines. There are database routines, routines to program the job control state machine, and some configuration routines.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vmu_viewersupport_pm">5.5.3. <code>vmu_ViewerSupport.pm</code></h4>
<div class="paragraph">
<p>This provides the viewer job specific routines. There are database routines, viewer state routines to support managing the viewer state in the collector, and logging support routines.</p>
</div>
</div>
<div class="sect3">
<h4 id="_codedx_pm">5.5.4. <code>CodeDX.pm</code></h4>
<div class="paragraph">
<p>This provides the interface to the codedx tomcat based web application. Communication and data transmission is obtained by curl command calls, using the Perl <code>system</code> command.</p>
</div>
</div>
<div class="sect3">
<h4 id="_floodlightaccess_pm">5.5.5. <code>FloodlightAccess.pm</code></h4>
<div class="paragraph">
<p>This provides the interface to the <code>floodlight</code> flow control software that is used in the multi-host facility in order to constrain access to the assessment machine public ip space. This machine ip space is typically accessed from the general public ip space to allow end user access to assessment machines for inspection while jobs are executing. It also controls internal access to license servers for those commercial tools that require license for operation and use.</p>
</div>
</div>
<div class="sect3">
<h4 id="_frameworkutils_pm">5.5.6. <code>FrameworkUtils.pm</code></h4>
<div class="paragraph">
<p>This provides the error analysis functionality that is driven the the assessment <code>status.out</code> file produced by the framework. There is an extensive document that describes the results produced by the assessment framework, with instructions for its interpretation and presentation.</p>
</div>
</div>
<div class="sect3">
<h4 id="_locking_pm">5.5.7. <code>Locking.pm</code></h4>
<div class="paragraph">
<p>This provides locking and mutual exclusion for the daemons to ensure that only one daemon or background process can run at any time.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mongodbutils_pm">5.5.8. <code>mongoDBUtils.pm</code></h4>
<div class="paragraph">
<p>This provides the interface to MongoDB which is utilized for storing large data blobs. Future work includes searching and filtering of result data.</p>
</div>
</div>
<div class="sect3">
<h4 id="_packagetypes_pm">5.5.9. <code>PackageTypes.pm</code></h4>
<div class="paragraph">
<p>This provides the enumeration of the package type constants that match the constants in the database. This data should ideally be queried from the database as the authoritative source for this data so as to avoid synchronization issues.</p>
</div>
</div>
<div class="sect3">
<h4 id="_scarfxmlreader_pm">5.5.10. <code>ScarfXmlReader.pm</code></h4>
<div class="paragraph">
<p>This provides the Perl support for stream parsing of SCARF xml files.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_htcondor_command_utilization">5.6. HTCondor Command Utilization</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Subroutines That Call HTConder Commands (via Module)</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Module</th>
<th class="tableblock halign-left valign-top">Subroutine</th>
<th class="tableblock halign-left valign-top">Command(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_ViewerSupport</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>updateClassAdViewerStatus</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_advertise</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getViewerStateFromClassAd</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_status</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_AssessmentSupport</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>updateClassAdAssessmentStatus</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_advertise</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_Support</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getHTCondorJobId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_status</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_q</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HTCondorJobStatus</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_status</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_q</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>identifyPreemptedJobs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_q</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isJobInHistory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_history</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isJobInQueue</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_q</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getRunDirHistory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_history</code></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Subroutines That Call HTConder Commands (via Script)</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Calling Script ( * Daemon )</th>
<th class="tableblock halign-left valign-top">Subroutine</th>
<th class="tableblock halign-left valign-top">Command(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_csa_agent.pl</code>*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condorJobExists</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_history</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_q</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>startHTCondorJob</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_submit</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_killrun.pl</code> via <code>vmu_LaunchPad.pl</code>*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_launchpadKill</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_rm</code></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Subroutines Called by Script</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Subroutine</th>
<th class="tableblock halign-left valign-top">Script</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>updateClassAdViewerStatus</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_killrun.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_csa_agent.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_AgentMonitor.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_launchviewer.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_PreViewer.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_MonitorViewer.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_PostViewer.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getViewerStateFromClassAd</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_AgentMonitor.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_launchviewer.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>updateClassAdAssessmentStatus</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_killrun.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_csa_agent.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_calldorun.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_PreAssessment.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_MonitorAssessment.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_PostAssessment.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getHTCondorJobId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_killrun.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HTCondorJobStatus</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_killrun.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>identifyPreemptedJobs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_csa_agent.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condorJobExists</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_csa_agent.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>startHTCondorJob</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_csa_agent.pl</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>launchPadKill</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vmu_killrun.pl</code></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. HTCondor Commands Called by Subroutine</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Command</th>
<th class="tableblock halign-left valign-top">Subroutine</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_advertise</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>updateClassAdViewerStatus</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>updateClassAdAssessmentStatus</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_status</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getViewerStateFromClassAd</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_getHTCondorSubmitNode</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_q</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getHTCondorJobId</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HTCondorJobStatus</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>identifyPreemptedJobs</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isJobInQueue</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_history</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isJobInHistory</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getRunDirHistory</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_submit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>startHTCondorJob</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>condor_rm</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_launchpadKill</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_building_the_perl_runtime_distribution_archive">5.7. Building the Perl Runtime Distribution Archive</h3>
<div class="paragraph">
<p>These instructions assume that the SWAMP deployment project from git has been cloned into SWAMP/deployment. The literal string <code>&lt;major.minor.patch&gt;</code> in these instructions are to be substituted with the literal string representing the <code>major.minor.patch</code> version string of the new Perl core installation.</p>
</div>
<div class="paragraph">
<p>The Perl runtime must be installed to <code>/opt/perl5</code>.</p>
</div>
<div class="listingblock">
<div class="title">Install perlbrew to obtain the core Perl distribution</div>
<div class="content">
<pre class="highlight"><code>curl -L https://install.perlbrew.pl | bash
export PERLBREW_ROOT=/opt/perl5
perlbrew init
perlbrew install perl-&lt;major.minor.patch&gt; <i class="conum" data-value="1"></i><b>(1)</b>
export PATH=/opt/perl5/perls/perl-&lt;major.minor.patch&gt;/bin:$PATH <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>E.g. <code>&lt;major.minor.patch&gt;</code> = <code>5.26.1</code></td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Install additional Perl modules using cpanm</div>
<div class="content">
<pre class="highlight"><code>Log::Log4perl
File::Remove
XML::Parser <i class="conum" data-value="1"></i><b>(1)</b>
RPC::XML::Server
Readonly
ConfigReader::Simple
Data::UUID
DBI
JSON
Date::Parse
XML::LibXML
XML::LibXSLT <i class="conum" data-value="2"></i><b>(2)</b>
XML::XPath
DBD::mysql <i class="conum" data-value="3"></i><b>(3)</b>
File::Slurp
MongoDB
XML::Simple</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>XML-Parser requires expat-devel (<code>yum install expat-devel</code>)</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>XML::LibXSLT requires libxslt and libxml2 and their *-devel packages (<code>yum install libxml2-devel libxslt-devel</code>)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>DBD::mysql requires mysql-devel (<code>yum install mysql-devel</code>)</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Additional Perl modules for SWAMP Perl Runtime are installed using <code>cpanm &lt;module-name&gt;</code>. Repeat this command while replacing <code>&lt;module-name&gt;</code> with a module from the list above.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Perl runtime must be built on CentOS 6 to be compatible with both CentOS 6 and CentOS 7.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Building the Perl Runtime Archive</div>
<div class="content">
<pre class="highlight"><code>cd /opt/perl5

# Remove all folders except the one named 'perls'.
# /opt/perl5/perls should have one folder
# named `perl-&lt;major.minor.patch&gt;'. <i class="conum" data-value="1"></i><b>(1)</b>

cd /opt
sudo tar -czvf perlbin_exec_w-&lt;major.minor.patch&gt;.tar.gz ./perl5
mv perlbin_exec_w-&lt;major.minor.patch&gt;.tar.gz SWAMP/deployment/perl/.

# edit SWAMP/deployment/inventory/dependencies.txt
#  change the perl: to read perl:&lt;major.minor.patch&gt; <i class="conum" data-value="1"></i><b>(1)</b>

# To perform Perl syntax checking on the SWAMP Perl code
# after the Perl Runtime upgrade:

cd SWAMP/services/perl/agents
for f in *.pl; do perl -cw $f; done
cd SWAMP/services/perl/vmtools
for f in masterify_vm start_vm vm_cleanup vm_masterinfo vm_output; do perl -cw $f; done</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>e.g. <code>&lt;major.minor.patch&gt;</code> = <code>5.26.1</code></td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.37<br>
Last updated 2020-12-30 19:58:19 -0600
</div>
</div>
</body>
</html>